[gd_scene load_steps=30 format=3 uid="uid://day2xcnccv5hs"]

[ext_resource type="Script" uid="uid://buqgg8dfnullo" path="res://Characters/player.gd" id="1_glv2v"]
[ext_resource type="PackedScene" uid="uid://7ve3ekf4n0ty" path="res://complete_build_textured.tscn" id="1_j4qnp"]
[ext_resource type="Script" uid="uid://br1oj1tpl4q58" path="res://Characters/shopkeep.gd" id="2_uu6xs"]
[ext_resource type="Script" uid="uid://bn8fr2xxcjhqo" path="res://Characters/Monster/dialog_area.gd" id="5_5vvyt"]
[ext_resource type="Script" uid="uid://bnynnhenm4lrd" path="res://Characters/Monster/chase_trigger.gd" id="6_3dxm6"]
[ext_resource type="Script" uid="uid://j3w11x0lxwdm" path="res://NPC_2.gd" id="7_c2ibq"]
[ext_resource type="PackedScene" uid="uid://c30ycudpmblgy" path="res://Characters/scaredgaurd.glb" id="7_fpfj3"]
[ext_resource type="Script" uid="uid://c8o2jp4whgcnt" path="res://Characters/Monster/chase_controller.gd" id="7_trn2v"]
[ext_resource type="PackedScene" uid="uid://qm4ftgj2s36h" path="res://Characters/shopkeep4.glb" id="8_c6i3y"]
[ext_resource type="PackedScene" uid="uid://d3sxwuv4j0tku" path="res://Characters/WIZARD.glb" id="8_sc1dx"]
[ext_resource type="Script" uid="uid://cl34fj6k0gbfw" path="res://Characters/Monster/death_area.gd" id="9_03owx"]
[ext_resource type="PackedScene" uid="uid://case0ouywui0f" path="res://helmetwip.glb" id="9_c2ibq"]
[ext_resource type="Script" uid="uid://dvyhamwioef37" path="res://UI/dialog_ui.gd" id="11_20pc6"]
[ext_resource type="Script" uid="uid://b3fijel3wd3eo" path="res://Characters/chase_trigger.gd" id="11_c2ibq"]
[ext_resource type="Script" uid="uid://wr6lipgv8ubd" path="res://UI/pause_menu.gd" id="13_fpfj3"]
[ext_resource type="Script" uid="uid://6jyaognxeiv2" path="res://Scripts/StartSpawn.gd" id="15_j4qnp"]
[ext_resource type="Script" uid="uid://bskpnejdds4g8" path="res://checkpoint.gd" id="16_fpfj3"]

[sub_resource type="Environment" id="Environment_fos0i"]
background_mode = 1
ambient_light_energy = 0.1
tonemap_exposure = 0.3

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_rxg2q"]
radius = 0.8
height = 2.5

[sub_resource type="CylinderShape3D" id="CylinderShape3D_uu6xs"]
height = 4.0
radius = 3.83545

[sub_resource type="BoxShape3D" id="BoxShape3D_fos0i"]
size = Vector3(50.924, 30.2782, 54.3808)

[sub_resource type="Curve3D" id="Curve3D_3dxm6"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 40, 0, 10, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, -138, 0, 0, 0, 0, 0, 0, 0, 0, -138, 0, -80),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4

[sub_resource type="BoxShape3D" id="BoxShape3D_lgr22"]
size = Vector3(32.7984, 31.8876, 8.04089)

[sub_resource type="BoxShape3D" id="BoxShape3D_c2ibq"]
size = Vector3(31, 14, 4)

[sub_resource type="Curve3D" id="Curve3D_c6i3y"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -86, 0, 0, 0, 0, 0, 0, 0, 0, -86, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 90),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4

[sub_resource type="BoxShape3D" id="BoxShape3D_c6i3y"]
size = Vector3(39, 19, 35)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_5vvyt"]
bg_color = Color(0.356863, 0.356863, 0.356863, 0.521569)

[sub_resource type="BoxShape3D" id="BoxShape3D_j4qnp"]
size = Vector3(1, 6, 5)

[sub_resource type="BoxShape3D" id="BoxShape3D_fpfj3"]
size = Vector3(15, 11, 1)

[node name="Main" type="Node3D" groups=["game_over_menu", "player", "player_global", "sucess_menu"]]

[node name="Environment" type="Node" parent="."]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Environment"]
transform = Transform3D(0.866025, -0.353553, 0.353554, 0, 0.707107, 0.707106, -0.5, -0.612372, 0.612373, 30.6436, 14.8404, 0)
light_energy = 30.0
light_indirect_energy = 10.0
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="Environment"]
environment = SubResource("Environment_fos0i")

[node name="CastleRoot" type="Node" parent="Environment"]

[node name="Complete_Build_Textured" parent="Environment/CastleRoot" instance=ExtResource("1_j4qnp")]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 17.6463, 42.3379)

[node name="Characters" type="Node" parent="."]

[node name="Player" type="CharacterBody3D" parent="Characters" groups=["player", "player_global", "sucess_menu"]]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 1.60044, 18.6336, 13.3627)
script = ExtResource("1_glv2v")

[node name="OmniLight3D" type="OmniLight3D" parent="Characters/Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.41083, 0)
light_color = Color(0.909804, 0.592157, 0, 1)
light_energy = 4.0
light_indirect_energy = 0.0
distance_fade_begin = 0.0
distance_fade_length = 30.0
omni_range = 20.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.8, 0)
shape = SubResource("CapsuleShape3D_rxg2q")

[node name="PivotYaw" type="Node3D" parent="Characters/Player"]
visible = false

[node name="PivotPitch" type="Node3D" parent="Characters/Player/PivotYaw"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.56719, 0)

[node name="Camera3D" type="Camera3D" parent="Characters/Player/PivotYaw/PivotPitch"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.569172, 0)

[node name="Shopkeep" type="Node3D" parent="Characters" groups=["player"]]
transform = Transform3D(0.707107, 0, 0.707107, 0, 1, 0, -0.707107, 0, 0.707107, -10.0867, 9.9145, -106.279)
script = ExtResource("2_uu6xs")

[node name="shopkeep4" parent="Characters/Shopkeep" instance=ExtResource("8_c6i3y")]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0)

[node name="Area3D" type="Area3D" parent="Characters/Shopkeep"]
script = ExtResource("5_5vvyt")
dialog_lines = Array[String]([])

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/Shopkeep/Area3D"]
shape = SubResource("CylinderShape3D_uu6xs")

[node name="Label3D" type="Label3D" parent="Characters/Shopkeep"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="Characters/Shopkeep"]

[node name="Shopkeep2" type="Node3D" parent="Characters" groups=["player"]]
transform = Transform3D(0.707107, 0, 0.707107, 0, 1, 0, -0.707107, 0, 0.707107, -265.052, -4.0855, -222.104)
script = ExtResource("7_c2ibq")

[node name="scaredgaurd" parent="Characters/Shopkeep2" instance=ExtResource("7_fpfj3")]
transform = Transform3D(-1.5, 0, -1.78814e-07, 0, 1.5, 0, 1.78814e-07, 0, -1.5, 0, 0, 0)

[node name="Area3D" type="Area3D" parent="Characters/Shopkeep2"]
script = ExtResource("5_5vvyt")
dialog_lines = Array[String]([])

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/Shopkeep2/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_uu6xs")

[node name="Label3D" type="Label3D" parent="Characters/Shopkeep2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="Characters/Shopkeep2"]

[node name="WIZARD" parent="Characters" instance=ExtResource("8_sc1dx")]
transform = Transform3D(-1.09278e-07, 0, -2.5, 0, 2.5, 0, 2.5, 0, -1.09278e-07, -254.006, -49.3722, -3.74041)

[node name="OmniLight3D" type="OmniLight3D" parent="Characters/WIZARD"]
transform = Transform3D(0.4, 0, -1.77636e-15, 0, 0.4, 0, 1.77636e-15, 0, 0.4, 1.19209e-07, 1.65892, -1.77167)
light_color = Color(0.976718, 0.574041, 2.69532e-06, 1)
light_energy = 15.0
omni_range = 10.0

[node name="MonsterChase1" type="Node" parent="Characters"]

[node name="ChaseTrigger" type="Area3D" parent="Characters/MonsterChase1" node_paths=PackedStringArray("chase_controller") groups=["game_over_menu", "player", "player_global"]]
script = ExtResource("6_3dxm6")
chase_controller = NodePath("../ChaseController")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/MonsterChase1/ChaseTrigger"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -116.795, 24.1797, -78.8494)
shape = SubResource("BoxShape3D_fos0i")

[node name="ChaseController" type="Node3D" parent="Characters/MonsterChase1" node_paths=PackedStringArray("path_follow", "monster_root", "death_area") groups=["game_over_menu", "player", "player_global"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -112.686, 18.3799, -79.076)
script = ExtResource("7_trn2v")
path_follow = NodePath("MonsterPath/MonsterPathFollow")
monster_root = NodePath("MonsterPath/MonsterPathFollow/MonsterRoot")
death_area = NodePath("MonsterPath/MonsterPathFollow/MonsterRoot/DeathArea")
speed = 10.0

[node name="MonsterPath" type="Path3D" parent="Characters/MonsterChase1/ChaseController"]
curve = SubResource("Curve3D_3dxm6")

[node name="MonsterPathFollow" type="PathFollow3D" parent="Characters/MonsterChase1/ChaseController/MonsterPath"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 40, 0, 10)
rotation_mode = 4
loop = false

[node name="MonsterRoot" type="Node3D" parent="Characters/MonsterChase1/ChaseController/MonsterPath/MonsterPathFollow"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 0, 0.597542)

[node name="helmetwip" parent="Characters/MonsterChase1/ChaseController/MonsterPath/MonsterPathFollow/MonsterRoot" instance=ExtResource("9_c2ibq")]
transform = Transform3D(-8.74228e-08, 0, -2, 0, 2, 0, 2, 0, -8.74228e-08, 0, -8.57988, 0)

[node name="OmniLight3D" type="OmniLight3D" parent="Characters/MonsterChase1/ChaseController/MonsterPath/MonsterPathFollow/MonsterRoot/helmetwip"]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 6, 2)
light_color = Color(0.786888, 0.473947, 1.92523e-07, 1)
light_energy = 2.0
light_specular = 10.0
omni_range = 16.0

[node name="DeathArea" type="Area3D" parent="Characters/MonsterChase1/ChaseController/MonsterPath/MonsterPathFollow/MonsterRoot"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 0, 0)
script = ExtResource("9_03owx")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/MonsterChase1/ChaseController/MonsterPath/MonsterPathFollow/MonsterRoot/DeathArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.861923, 6.83563, 0.0282593)
shape = SubResource("BoxShape3D_lgr22")

[node name="MonsterChase2" type="Node" parent="Characters"]

[node name="ChaseTrigger2" type="Area3D" parent="Characters/MonsterChase2" node_paths=PackedStringArray("chase_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -183, -64, -50)
script = ExtResource("11_c2ibq")
chase_controller = NodePath("../ChaseController2")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/MonsterChase2/ChaseTrigger2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -15, 6.5, -11.5)
shape = SubResource("BoxShape3D_c2ibq")

[node name="ChaseController2" type="Node3D" parent="Characters/MonsterChase2" node_paths=PackedStringArray("path_follow", "monster_root", "death_area") groups=["game_over_menu", "player", "player_global"]]
script = ExtResource("7_trn2v")
path_follow = NodePath("MonsterPath/MonsterPathFollow")
monster_root = NodePath("MonsterPath/MonsterPathFollow/MonsterRoot2")
death_area = NodePath("MonsterPath/MonsterPathFollow/MonsterRoot2/DeathArea")
speed = 12.0

[node name="MonsterPath" type="Path3D" parent="Characters/MonsterChase2/ChaseController2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -156.696, -62.5528, -52.5736)
curve = SubResource("Curve3D_c6i3y")

[node name="MonsterPathFollow" type="PathFollow3D" parent="Characters/MonsterChase2/ChaseController2/MonsterPath"]
transform = Transform3D(0, 0, 1, 0, 1, 0, -1, 0, 0, 0, 0, 0)
rotation_mode = 4

[node name="MonsterRoot2" type="Node3D" parent="Characters/MonsterChase2/ChaseController2/MonsterPath/MonsterPathFollow"]

[node name="helmetwip" parent="Characters/MonsterChase2/ChaseController2/MonsterPath/MonsterPathFollow/MonsterRoot2" instance=ExtResource("9_c2ibq")]
transform = Transform3D(-2.5, 0, -2.18557e-07, 0, 2.5, 0, 2.18557e-07, 0, -2.5, 0, -1.55339, 0)

[node name="OmniLight3D" type="OmniLight3D" parent="Characters/MonsterChase2/ChaseController2/MonsterPath/MonsterPathFollow/MonsterRoot2/helmetwip"]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 6, 2)
light_color = Color(0.786888, 0.473947, 1.92523e-07, 1)
light_energy = 2.0
light_specular = 10.0
omni_range = 16.0

[node name="DeathArea" type="Area3D" parent="Characters/MonsterChase2/ChaseController2/MonsterPath/MonsterPathFollow/MonsterRoot2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -10)
script = ExtResource("9_03owx")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Characters/MonsterChase2/ChaseController2/MonsterPath/MonsterPathFollow/MonsterRoot2/DeathArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 9, 17)
shape = SubResource("BoxShape3D_c6i3y")

[node name="UI" type="Node" parent="."]

[node name="PauseMenuLayer" type="CanvasLayer" parent="UI"]
script = ExtResource("13_fpfj3")

[node name="PauseMenu" type="Control" parent="UI/PauseMenuLayer"]
process_mode = 2
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ColorRect" type="ColorRect" parent="UI/PauseMenuLayer/PauseMenu"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.596078, 0.596078, 0.596078, 0.564706)

[node name="VBoxContainer" type="VBoxContainer" parent="UI/PauseMenuLayer/PauseMenu"]
custom_minimum_size = Vector2(9, 0)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -221.5
offset_top = -189.0
offset_right = 221.5
offset_bottom = 189.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 12
alignment = 1

[node name="Resume" type="Button" parent="UI/PauseMenuLayer/PauseMenu/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 80
text = "Resume"

[node name="Main Menu" type="Button" parent="UI/PauseMenuLayer/PauseMenu/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 80
text = "Main Menu"

[node name="Quit" type="Button" parent="UI/PauseMenuLayer/PauseMenu/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 80
text = "Quit"

[node name="SuccessMenu" type="CanvasLayer" parent="UI" groups=["player", "player_global", "sucess_menu"]]
visible = false

[node name="Panel" type="Panel" parent="UI/SuccessMenu"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="CenterContainer" type="CenterContainer" parent="UI/SuccessMenu/Panel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="UI/SuccessMenu/Panel/CenterContainer"]
layout_mode = 2
theme_override_constants/separation = 20

[node name="EscapeText" type="Label" parent="UI/SuccessMenu/Panel/CenterContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 60
text = "You Escaped!"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Retry" type="Button" parent="UI/SuccessMenu/Panel/CenterContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 40
text = "Retry"

[node name="Quit" type="Button" parent="UI/SuccessMenu/Panel/CenterContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 40
text = "Quit"

[node name="Dialog" type="Node" parent="UI"]

[node name="DialogUI" type="CanvasLayer" parent="UI/Dialog"]
process_mode = 3
script = ExtResource("11_20pc6")

[node name="DialogPanel" type="Control" parent="UI/Dialog/DialogUI"]
custom_minimum_size = Vector2(0, 180)
layout_mode = 3
anchor_left = 0.025
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 71.2
offset_top = -348.0
offset_right = -166.0
offset_bottom = -168.0
grow_horizontal = 2
grow_vertical = 0

[node name="Panel2" type="Panel" parent="UI/Dialog/DialogUI/DialogPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -10.0
offset_top = -7.0
offset_right = -11.0
offset_bottom = 8.0
grow_horizontal = 2
grow_vertical = 2

[node name="Panel" type="Panel" parent="UI/Dialog/DialogUI/DialogPanel"]
clip_contents = true
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = -20.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_5vvyt")

[node name="MarginContainer" type="MarginContainer" parent="UI/Dialog/DialogUI/DialogPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 81.0
offset_right = -9.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(0.9, 0.9)

[node name="DialogLabel" type="Label" parent="UI/Dialog/DialogUI/DialogPanel/MarginContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 100
text = "Text"
autowrap_mode = 2

[node name="Checkpoints" type="Node" parent="."]

[node name="StartSpawn" type="Node3D" parent="Checkpoints"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 2, 19, 13)
script = ExtResource("15_j4qnp")

[node name="Checkpoint1" type="Area3D" parent="Checkpoints"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -17, 12, -80)
script = ExtResource("16_fpfj3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Checkpoints/Checkpoint1"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 0, 0)
shape = SubResource("BoxShape3D_j4qnp")

[node name="Checkpoint2" type="Area3D" parent="Checkpoints"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, -200, -63, -80)
script = ExtResource("16_fpfj3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Checkpoints/Checkpoint2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 0)
shape = SubResource("BoxShape3D_fpfj3")
